extends layout.pug
block content
    -
        function stdName(val) {
            switch(val) {
                case 'new':
                    return 'New';
                case 'estimate':
                    return 'Estimate';
                case 'in-progress':
                    return 'In-Progress';
                case 'payment':
                    return 'Payment';
                case 'complete':
                    return 'Complete';
                case 'grant':
                    return 'grant';
                case 'immediately':
                    return 'Immediately';
                case '1-3':
                    return '1-3 Months';
                case '3-6':
                    return '3-6 Months';
                case '6_or_more':
                    return '6+ Months';
                case 'research_only':
                    return 'Research Only';
                case 'clinical_applications':
                    return 'Clinical Applications';
                case 'quote':
                    return 'Quote';
                default:
                    return val;
            }
        }

    h2(style="float: left;")="Order #"+order.id
        span.badge.badge-primary(style="margin-left: 5px;")
            | #{stdName(order.state)}
    -var date = (new Date(order.updatedAt)).toLocaleString('en-US', { month: 'long', day: '2-digit', year: 'numeric' });
    h4(style="float: right;")="Ordered: "+date
    br
    br
    br
    #orderInfo
        b="Nature of Inquiry: "
        span(id='reason')=stdName(order.inquiry_type)
        br
        b="Time Estimate: "
        span(id='time_estimate')=stdName(order.time_estimate)
        br
        b="Intended Use: "
        span(id='intended_use')=stdName(order.intended_use)
    br
    button.btn.btn-success(style="float: right;" id="edit_button") Edit
    br
    h5 Items
    if order.items != null || order.items.isEmpty()
        table.table.table-striped
            thead
                tr
                    th(scope="col") Category 
                    th(scope="col") Item Name
                    th(scope="col") Price
            tbody
                each item in order.items
                    tr
                        td=(item.inventory == null || item.inventory.category == null) ? "" : item.inventory.category
                        td=(item.inventory == null || item.inventory.name == null) ? "" : item.inventory.name
                        td="$"+order.amount
    else
        p There are no payments.

    h5 Payments
    if order.payments != null && order.payments.length > 0
        table.table.table-striped
            thead
                tr
                    th(scope="col") Reference #
                    th(scope="col") Method
                    th(scope="col") Amount
            tbody
                each payment in order.payments
                    tr
                        td=payment.reference_number
                        td=payment.method
                        td="$"+payment.amount
    else
        p There are no payments.
    script(src='/js/order.js')